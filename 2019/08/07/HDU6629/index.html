<!DOCTYPE html>
<html lang="en">
<head><meta name="generator" content="Hexo 3.9.0">
    <script src="https://apps.bdimg.com/libs/jquery/2.1.4/jquery.min.js">
</script>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, user-scalable=no, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0">
<meta http-equiv="X-UA-Compatible" content="ie=edge">



<title>È¢òËß£ÔºöHDU6629 String Mathching | KONGJUNE&#39;s BLOG</title>



    <link rel="icon" type="image/png" href="/favicon.png">




    <!-- stylesheets list from _config.yml -->
    
    <link rel="stylesheet" href="/css/style.css">
    



    <!-- scripts list from _config.yml -->
    
    <script src="/js/script.js"></script>
    
    <script src="/js/tocbot.min.js"></script>
    
    <script src="/js/timeCount.js"></script>
    



    
    
        <!-- MathJaxÈÖçÁΩÆÔºåÂèØÈÄöËøáÂçïÁæéÂÖÉÁ¨¶Âè∑‰π¶ÂÜôË°åÂÜÖÂÖ¨ÂºèÁ≠â -->
<script type="text/x-mathjax-config">
    MathJax.Hub.Config({
    "HTML-CSS": {
        preferredFont: "TeX",
        availableFonts: ["STIX","TeX"],
        linebreaks: { automatic:true },
        EqnChunk: (MathJax.Hub.Browser.isMobile ? 10 : 50)
    },
    tex2jax: {
        inlineMath: [ ["$", "$"], ["\\(","\\)"] ],
        processEscapes: true,
        ignoreClass: "tex2jax_ignore|dno",
        skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
    },
    TeX: {
        equationNumbers: { autoNumber: "AMS" },
        noUndefined: { attributes: { mathcolor: "red", mathbackground: "#FFEEEE", mathsize: "90%" } },
        Macros: { href: "{}" }
    },
    messageStyle: "none"
    });
</script>
<!-- ÁªôMathJaxÂÖÉÁ¥†Ê∑ªÂä†has-jax class -->
<script type="text/x-mathjax-config">
    MathJax.Hub.Queue(function() {
        var all = MathJax.Hub.getAllJax(), i;
        for(i=0; i < all.length; i += 1) {
            all[i].SourceElement().parentNode.className += ' has-jax';
        }
    });
</script>
<!-- ÈÄöËøáËøûÊé•CDNÂä†ËΩΩMathJaxÁöÑjs‰ª£Á†Å -->
<script type="text/javascript" async src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-MML-AM_CHTML">
</script>


    


</head>
<body>
    <div class="wrapper">
        <script>
    $("#toTop").attr("style", "display:none;");
    $(function() {
        $(window).scroll(function() {
            var scroll_top = $(window).scrollTop();
            if (scroll_top >= 100) {
                $("#toTop").fadeIn();
            } else {
                $("#toTop").fadeOut();
            }
        })
    })
</script>
<header>
    <nav class="navbar">
        <div class="container">
            <div class="navbar-header header-logo"><a href="/">KONGJUNE&#39;s BLOG</a></div>
            <div class="menu navbar-right">
                
                <a class="menu-item" href="/archives">ÂΩíÊ°£</a>
                
                <a class="menu-item" href="/category">Á±ªÂà´</a>
                
                <a class="menu-item" href="/tag">Ê†áÁ≠æ</a>
                
                <a class="menu-item" href="/mc">Minecraft</a>
                
                <input id="switch_default" type="checkbox" class="switch_default" style="display: none;">
                <label for="switch_default" class="toggleBtn"></label>
            </div>

        </div>
    </nav>

    
    <nav class="navbar-mobile" id="nav-mobile">
        <div class="container">
            <div class="navbar-header">
                <div>
                    <a href="/">KONGJUNE&#39;s BLOG</a><a id="mobile-toggle-theme">¬∑&nbsp;Light</a>
                </div>
                <div class="menu-toggle" onclick="mobileBtn()">&#9776; Menu</div>
            </div>
            <div class="menu" id="mobile-menu">
                
                <a class="menu-item" href="/archives">ÂΩíÊ°£</a>
                
                <a class="menu-item" href="/category">Á±ªÂà´</a>
                
                <a class="menu-item" href="/tag">Ê†áÁ≠æ</a>
                
                <a class="menu-item" href="/mc">Minecraft</a>
                
            </div>
        </div>
    </nav>
</header>
<script>
    var mobileBtn = function f() {
        var toggleMenu = document.getElementsByClassName("menu-toggle")[0];
        var mobileMenu = document.getElementById("mobile-menu");
        if (toggleMenu.classList.contains("active")) {
            toggleMenu.classList.remove("active")
            mobileMenu.classList.remove("active")
        } else {
            toggleMenu.classList.add("active")
            mobileMenu.classList.add("active")
        }
    }
</script>
<body>
    <div id="toTop" class="box" style="z-index:9999;">
        <div class="box-in"></div>
    </div>
</body>
<script>
    var timer = null;
    toTop.onclick = function() {
        cancelAnimationFrame(timer);
        timer = requestAnimationFrame(function fn() {
            var oTop = document.body.scrollTop || document.documentElement.scrollTop;
            var sPeed = oTop / 10;
            if (oTop > 0) {
                document.body.scrollTop = document.documentElement.scrollTop = oTop - sPeed;
                timer = requestAnimationFrame(fn);
            } else {
                cancelAnimationFrame(timer);
            }
        });
    }
</script>

        <div class="main">
            <div class="container">
    
    
    <div class="post-toc">
    <div class="tocbot-list">
    </div>
    <div class="tocbot-list-menu">
        <a class="tocbot-toc-expand" onclick="expand_toc()">Â±ïÂºÄÂÖ®ÈÉ®ÁõÆÂΩï</a>
    </div>
</div>

<script>
    document.ready(
        function () {
            tocbot.init({
                tocSelector: '.tocbot-list',
                contentSelector: '.post-content',
                headingSelector: 'h1, h2, h3, h4, h5',
                collapseDepth: 1,
                orderedList: false,
                scrollSmooth: true,
            })
        }
    )

    function expand_toc() {
        var b = document.querySelector(".tocbot-toc-expand");
        tocbot.init({
            tocSelector: '.tocbot-list',
            contentSelector: '.post-content',
            headingSelector: 'h1, h2, h3, h4, h5',
            collapseDepth: 6,
            orderedList: false,
            scrollSmooth: true,
        });
        b.setAttribute("onclick", "collapse_toc()");
        b.innerHTML = "Êî∂Ëµ∑ÁõÆÂΩïÊ¨°È°π"
    }

    function collapse_toc() {
        var b = document.querySelector(".tocbot-toc-expand");
        tocbot.init({
            tocSelector: '.tocbot-list',
            contentSelector: '.post-content',
            headingSelector: 'h1, h2, h3, h4, h5',
            collapseDepth: 1,
            orderedList: false,
            scrollSmooth: true,
        });
        b.setAttribute("onclick", "expand_toc()");
        b.innerHTML = "Â±ïÂºÄÂÖ®ÈÉ®ÁõÆÂΩï"
    }
</script>

    

    
    <article class="post-wrap">
        <header class="post-header">
            <h1 class="post-title">È¢òËß£ÔºöHDU6629 String Mathching</h1>
            
            <div class="post-meta">
                
                ÁºñËÄÖ: <a itemprop="author" rel="author" href="/">KONGJUNE</a>
                

                
                <span class="post-time">
                    Êó•Êúü: <a href="#">2019-08-07&nbsp;&nbsp;12:00:09</a>
                </span>
                
                
                <span class="post-category">
                    Á±ªÂà´:
                    
                    <a href="/categories/Solution/">Solution</a>
                    
                </span>
                
            </div>
            
        </header>
        
        <div style="
            background-image: url(/img/HDU6629/banner.jpg);
            height: 300px;
            background-position-x: center;
            background-position-y: center;
            background-repeat: no-repeat;
            -moz-background-size:100% 100%;
            background-size:cover;
        ">
            <p> </p>
        </div>
        
        
            <p class="copyright-item">
                <span><i style="color: gray;">Êú¨ÊñáÊúÄÂêé‰øÆÊîπ‰∫é:</i></span>
                <span><i style="color: gray;">2019-10-13&nbsp;&nbsp;13:53:51</i></span>
            </p>
        
        <div class="post-content">
            <p>Êú¨È¢ò‰∏∫ <strong>2019 HDU Multi-University Training Contest 5 ÁöÑ 1007 È¢ò</strong>„ÄÇ</p>
<p>È¢òÁõÆ‰º†ÈÄÅÈó®Ôºö<a href="http://acm.hdu.edu.cn/showproblem.php?pid=6629" target="_blank" rel="noopener">üö™</a></p>
<blockquote>
<h3 id="Problem-Description"><a href="#Problem-Description" class="headerlink" title="Problem Description"></a>Problem Description</h3><p>String matching is a common type of problem in computer science. One string matching problem is as following:</p>
<p>Given a string $S[0\cdots len‚àí1]$, please calculate the length of the longest common prefix of $S[i\cdots len‚àí1]$ and $S[0 \cdots len‚àí1]$ for each $i&gt;0$.</p>
<p>I believe everyone can do it by brute force.<br>The pseudo code of the brute force approach is as the following:</p>
<p><img src="/img/HDU6629/C722-1006-1.png" alt="img"></p>
<p>We are wondering, for any given string, what is the number of compare operations invoked if we use the above algorithm. Please tell us the answer before we attempt to run this algorithm.</p>
<h3 id="input"><a href="#input" class="headerlink" title="input"></a>input</h3><p>The first line contains an integer $T$, denoting the number of test cases.<br>Each test case contains one string in a line consisting of printable ASCII characters except space.</p>
<ul>
<li><p>$1 \leq T \leq 30$</p>
</li>
<li><p>string length $\leq 106$ for every string</p>
</li>
</ul>
<h3 id="Output"><a href="#Output" class="headerlink" title="Output"></a>Output</h3><p>For each test, print an integer in one line indicating the number of compare operations invoked if we run the algorithm in the statement against the input string.</p>
<h3 id="Sample-Input"><a href="#Sample-Input" class="headerlink" title="Sample Input"></a>Sample Input</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&gt; 3</span><br><span class="line">&gt; _Happy_New_Year_</span><br><span class="line">&gt; ywwyww</span><br><span class="line">&gt; zjczzzjczjczzzjc</span><br><span class="line">&gt;</span><br></pre></td></tr></table></figure>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&gt; </span><br><span class="line">&gt; ### Sample Output</span><br><span class="line">&gt;</span><br><span class="line">&gt;</span><br></pre></td></tr></table></figure>

<p>17<br>7<br>32 </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">## È¢òÊÑè &amp; ÁÆóÊ≥ï</span><br><span class="line"></span><br><span class="line">È¢òÁõÆÂ∞±ÊòØÈóÆÈ¢òÁõÆ‰∏≠Ëøô‰∏™ÁÆóÊ≥ï‰∏≠ÊØîËæÉÁöÑÊ¨°Êï∞„ÄÇÈ¢òÁõÆ‰∏≠ÊèêÂèäÁöÑÁÆóÊ≥ïÂ∞±ÊòØÊö¥ÂäõÂØπ‰∏≤‰∏≠ÊØè‰∏Ä‰∏™‰ΩçÁΩÆËøõË°åÂâçÁºÄÂåπÈÖç„ÄÇÊàë‰ª¨ÂèØ‰ª•Êé®Áü•ÔºåÂ¶ÇÊûúÂ≠ê‰∏≤ÈïøÂ∫¶‰∏∫ $x$ ÔºåÊàë‰ª¨Â∞±ÈúÄË¶ÅËøõË°å $x+1$ Ê¨°ÂåπÈÖçÔºàÂõ†‰∏∫ËøòÊúâ‰∏ÄÊ¨°ÂåπÈÖçÂ§±Ë¥•ÁöÑÊÉÖÂÜµÔºâ„ÄÇËÄåÂ¶ÇÊûúÊàëÂåπÈÖçÁöÑÂ≠ê‰∏≤ÊúÄÂêé‰∏Ä‰ΩçÂà∞Ëææ‰∫ÜÂéü‰∏≤ÁöÑÊúÄÂêé‰∏Ä‰ΩçÁöÑËØùÔºåÊàë‰ª¨Âè™ÈúÄË¶ÅËøõË°å $x$ Ê¨°ÂåπÈÖçÔºàÂõ†‰∏∫ÂåπÈÖçÂ§±Ë¥•ÁöÑÊÉÖÂÜµ‰∏ç‰ºöÂá∫Áé∞‰∫ÜÔºâ„ÄÇÊâÄ‰ª•Ëøô‰∏™ÈóÆÈ¢òÂ∞±ËΩ¨Êç¢Êàê‰∫ÜÂâçÁºÄÂåπÈÖç„ÄÇÊâ©Â±ïKMPÁÆóÊ≥ïÂ∞±ÊòØ‰∏∫ËøôÁßçÈóÆÈ¢ò‰∫ßÁîüÁöÑ„ÄÇ</span><br><span class="line"></span><br><span class="line">KMPÁÆóÊ≥ïËÆ≤Ëß£‰º†ÈÄÅÈó®Ôºö[üö™](http://www.kongjune.com/2019/08/06/%E6%89%A9%E5%B1%95KMP/)</span><br><span class="line"></span><br><span class="line">Ëøô‰∏™È¢òÊå∫ÂùëÁöÑÔºåÂêÑÁßçÂç°Êó∂Èó¥Âïä„ÄÇÂç°`memset()`ÔºàÂÖ∂ÂÆû‰πüÊ≤°ÂøÖË¶ÅÁî®`memset()`ÔºâÔºåÂç°`cin`‚Ä¶‚Ä¶T ‰∫Ü‰∏ÄÊôö‰∏äÊàëÊâçËøáÂéª‚Ä¶‚Ä¶</span><br><span class="line"></span><br><span class="line">## AC‰ª£Á†Å</span><br><span class="line"></span><br><span class="line">```C++</span><br><span class="line">#include &lt;bits/stdc++.h&gt;</span><br><span class="line">using namespace std;</span><br><span class="line">int nexts[1000006];</span><br><span class="line">char T[1000006];</span><br><span class="line">long long ans = 0;</span><br><span class="line">void getNext()&#123;</span><br><span class="line">    int m = strlen(T);</span><br><span class="line">    // m:TÁöÑÈïøÂ∫¶</span><br><span class="line">    int a = 0, p = 0;</span><br><span class="line">    for (int i = 1; i &lt; m; i++) &#123;</span><br><span class="line">        if (i &gt;= p || i + nexts[i - a] &gt;= p) &#123;</span><br><span class="line">            if (i &gt;= p) p = i;</span><br><span class="line">            while (p &lt; m &amp;&amp; T[p] == T[p - i])</span><br><span class="line">                p++;</span><br><span class="line">            nexts[i] = p - i;</span><br><span class="line">            if(i + nexts[i] &gt;= m)</span><br><span class="line">                ans += nexts[i];</span><br><span class="line">            else ans += nexts[i] + 1;</span><br><span class="line">            a = i;</span><br><span class="line">        &#125;</span><br><span class="line">        else&#123;</span><br><span class="line">            nexts[i] = nexts[i - a];</span><br><span class="line">            if(i + nexts[i] &gt;= m)</span><br><span class="line">                ans += nexts[i];</span><br><span class="line">            else ans += nexts[i] + 1;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">int main()&#123;</span><br><span class="line">    int n;</span><br><span class="line">    scanf(&quot;%d&quot;, &amp;n);</span><br><span class="line">    while(n--)&#123;</span><br><span class="line">        scanf(&quot;%s&quot;, T);</span><br><span class="line">        ans = 0;</span><br><span class="line">        getNext();</span><br><span class="line">        printf(&quot;%lld\n&quot;, ans);</span><br><span class="line">    &#125;</span><br><span class="line">    return 0;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>


        </div>
        
        <section class="post-copyright">
            
            <p class="copyright-item">
                <span>Êú¨Êñá‰ΩúËÄÖ:</span>
                <a itemprop="author" rel="author" href="/"><span>KONGJUNE</span></a>
            </p>
            
            
            
            <p class="copyright-item">
                <span>Êú¨ÊñáÈìæÊé•:</span>
                <span><a href="http://kongjune.com/2019/08/07/HDU6629/">http://kongjune.com/2019/08/07/HDU6629/</a></span>
            </p>
            
            <p class="copyright-item">
                <span>ÁâàÊùÉÂ£∞Êòé:</span>
                <span>Copyright (c) 2019 <a href="http://creativecommons.org/licenses/by-nc/4.0/">CC-BY-NC-4.0</a> LICENSE</span>
            </p>
            
            

        </section>
        
        <section class="post-tags">
            <div>
                <span>Êú¨ÊñáÊ†áÁ≠æ:</span>
                <span class="tag">
                    
                    
                    <a href="/tags/ACM/"># ACM</a>
                    
                    <a href="/tags/Programming/"># Programming</a>
                    
                    <a href="/tags/Solution/"># Solution</a>
                    
                    
                </span>
            </div>
            <div>
                <a href="javascript:window.history.back();">ËøîÂõû‰∏ä‰∏ÄÈ°µ</a>
                <span>¬∑ </span>
                <a href="/">ËøîÂõû‰∏ªÈ°µ</a>
            </div>
        </section>
        <section class="post-nav">
            
            <a class="prev" rel="prev" href="/2019/08/08/HDU6641/">È¢òËß£ÔºöHDU6641 TDL</a>
            
            
            <a class="next" rel="next" href="/2019/08/06/Êâ©Â±ïKMP/">ÁÆóÊ≥ïÂ≠¶‰π†ÔºöÊâ©Â±ïKMP</a>
            
        </section>
        <!-- Êù•ÂøÖÂäõCityÁâàÂÆâË£Ö‰ª£Á†Å -->
        <div id="lv-container" data-id="city" data-uid="MTAyMC80NTY1NC8yMjE2NQ==">
            <script type="text/javascript">
                (function(d, s) {
                    var j, e = d.getElementsByTagName(s)[0];

                    if (typeof LivereTower === 'function') {
                        return;
                    }

                    j = d.createElement(s);
                    j.src = 'https://cdn-city.livere.com/js/embed.dist.js';
                    j.async = true;

                    e.parentNode.insertBefore(j, e);
                })(document, 'script');
            </script>
            <noscript> ‰∏∫Ê≠£Â∏∏‰ΩøÁî®Êù•ÂøÖÂäõËØÑËÆ∫ÂäüËÉΩËØ∑ÊøÄÊ¥ªJavaScript</noscript>
        </div>
        <!-- CityÁâàÂÆâË£Ö‰ª£Á†ÅÂ∑≤ÂÆåÊàê -->
    </article>
</div>

        </div>
        <footer id="footer" class="footer">
    <div class="copyright" style="padding-bottom: 15px;">
        <span><font color="#657786">¬© 2019 ¬∑ </font><font color="#2d96bd">KONGJUNE</font> </span>
        <br>
        <span id="sitetime"></span>
        <br>
        <span><font color="#657786">Áî±</font><a href="https://hexo.io" target="_blank"><font color="#2d96bd"> Hexo </font></a><font color="#657786">Âº∫ÂäõÈ©±Âä® | ‰ΩøÁî®‰∏ªÈ¢ò</font><a href="https://github.com/Siricee/hexo-theme-Chic" target="_blank"><font color="#2d96bd"> Chic </font></a></span>
    </div>
</footer>

    </div>
</body>
</html>
